<!DOCTYPE html>
<html>
    <head><meta name="generator" content="Hexo 3.8.0">
        <!-- hexo-inject:begin --><!-- hexo-inject:end --><meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        
        <title>1.3.49 | 《算法（第四版）》C# 题解</title>
        
        <link rel="alternate" href="/atom.xml" title="《算法（第四版）》C# 题解" type="application/atom+xml">
        
        
        <link rel="icon" href="//favicon.ico">
        
        <link rel="stylesheet" href="/css/normalize.css">
        <link rel="stylesheet" href="/css/style.css">
        <link rel="stylesheet" href="/css/common.css">
        <link rel="stylesheet" href="/css/markdown.css"><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    <link rel="stylesheet" href="/css/prism-base16-ateliersulphurpool.light.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>
    <body onscroll="scrollYListener()">
        <!-- hexo-inject:begin --><!-- hexo-inject:end --><div class="wrapper">
            <div class="mobile_menu_btn">
  <button id="mobile_menu_btn" class="c-hamburger c-hamburger--htx">
  <span>toggle menu</span>
  </button>
</div>
<div class="slide_menu">
  <nav class="nav_scroll">
    <ul class="clearfix">
      
      
      <li class=""> <a href="/">主页</a> </li>
      
      
      <li class=""> <a href="/help">帮助</a> </li>
      
      
      <li class=""> <a href="/thanks">鸣谢</a> </li>
      
    </ul>
  </nav>
  <div class="social">
    <ul class="clearfix">
      
      
      <li> <a href="https://github.com/ikesnowy/Algorithms-4th-Edition-in-Csharp" target="_blank"> <img src="/img/GitHub.png"> </a> </li>
      
      
      
      
      
      
      
      
    </ul>
  </div>
  <div class="copyright">
    &copy; 2019 《算法（第四版）》C# 题解 | Provided By  <a title="沈星繁" href="http://chengkang.me/" target="_blank">沈星繁</a>
  </div>
</div>
<header>
  <div class="mobile_navbar clearfix">
    
    <div class="logo">
      <a href="/">《算法（第四版）》C# 题解</a>
    </div>
    
  </div>
  <div class="row clearfix no_form">
    <div class="logo">
      <a href="/">《算法（第四版）》C# 题解</a>
    </div>
    <nav class="nav_scroll">
      <ul class="clearfix">
      
      
      <li class=""> <a href="/">主页</a> </li>
      
      
      <li class=""> <a href="/help">帮助</a> </li>
      
      
      <li class=""> <a href="/thanks">鸣谢</a> </li>
      
      </ul>
    </nav>
  </div>
</header>
            <div class="section" id="Search">
	<div class="section_content">
		<h3>
		搜索解答
		<br>
		目前已完成到 2.5
		</h3>
		<div id="search-content" class="search-content-modal unexpanded">
			<div id="search-view">
				<div class="search-info box">
					<input type="text" id="search-input" placeholder="题目编号/关键字">
					<div class="magnifying-glass" id="search-button">
						<svg xmlns="https://www.w3.org/2000/svg" viewbox="0 0 500 500">
						<path fill="none" stroke="#fff" stroke-width="36" stroke-linecap="round" d="m280,278a153,153 0 1,0-2,2l170,170m-91-117 110,110-26,26-110-110"/>
					</svg>
				</div>
			</div>
			<div class="modal" id="search-result" style="display:none">
				<h2 id="search-result-title">Found 0 match(es):</h2>
				<ul id="search-result-list">
				</ul>
				<span>
					<button onclick="dismissSearchResultModal()">×</button>
				</span>
			</div>
		</div>
	</div>
</div>

<script src="/js/jquery-3.1.1.min.js"></script>
<script src="/js/search.js"></script>
<script type="text/javascript">
var path = "/search.xml";
searchFunc(path, 'search-input', 'search-result-list');
</script>

<script>
function dismissSearchResultModal() {
	document.getElementById("search-result").style.display = "none";
}
</script>
</div>
<div class="section" id="Post">
	<div class="section_content">
		<p class="breadcrumb">
			<a href="/">
				解答
			</a>/ 
			1.3.49

		</p>
		<div class="page_content mdcss">
			<h1>1.3.49</h1>
			<p>上次更新：2019-02-11</p>
			<h1 id="题目">题目</h1>
<p>1.3.49 栈与队列。 用有限个栈实现一个队列， 保证每个队列操作（在最坏情况下）都只需要常数次的栈操作。</p>
<h1 id="解答">解答</h1>
<p>那么这里就使用六个栈来解决这个问题。 这个算法来自于<a href="https://ecommons.cornell.edu/bitstream/handle/1813/6273/80-433.pdf?sequence=1&amp;isAllowed=y" target="_blank" rel="noopener">这篇论文</a>。</p>
<p>原文里用的是 Pure Lisp，不过语法很简单，还是很容易看懂的。</p>
<h2 id="先导知识用两个栈模拟一个队列">先导知识——用两个栈模拟一个队列</h2>
<p>如何使用两个栈来模拟一个队列操作？ 这是一道很经典的题目，答案也有很多种，这里只介绍之后会用到的一种方法。 首先我们有两个栈，H 和 T，分别用作出队和入队用。 <img src="./1.png"> 这样，入队操作等同于向 T 添加元素，T 的入栈操作只需要 O(1) 时间。 <img src="./2.png"> 如果 H 不为空，出队操作等同于 H 弹栈，H 的弹栈操作也只需要 O(1) 时间。 <img src="./3.png"> 但如果 H 为空，则需要将 T 中的元素依次弹出并压入到 H 中，这是一个 O(n) 的操作。 <img src="./4.png"> 显然，这种方式中，出队操作的最坏时间复杂度是 O(n)，并不满足题目要求。</p>
<h2 id="分摊-on">分摊 O(n)</h2>
<p>那么，怎么解决这个问题呢？ 一个很自然的想法是，如果在栈 H 变为空之前，我们就能逐步将栈 T 的内容弹出并压入到另一个栈 H' 中，等到栈 H 为空时，直接交换 H 和 H' 即可。</p>
<p>假设目前的队列状态是这样，有三个元素等待出队，还有三个元素等待入队。 <img src="./5.png"> 现在依次让三个元素出队，与此同时我们让栈 T 中的元素依次进入 H' 中。 每一次出队都执行两个操作，元素出队和元素复制（Pop &amp; Push），时间复杂度 O(1) + O(1) + O(1) = O(1)。</p>
<p>第一次操作（出队） <img src="./6.png"> 第二次操作（出队） <img src="./7.png"> 第三次操作（出队） <img src="./8.png"> 现在栈 H 和栈 T 都为空，下一次出队操作时，我们直接交换栈 H 和栈 H'（由于是交换引用，因此时间复杂度仍为 O(1)）。 <img src="./9.png"> 之后再进行出队操作。</p>
<p>这就是这个算法基本想法，在栈 H 变为空之前，分步将栈 T 中的内容分步复制到另一个栈中。 当栈 H 为空时直接用准备好的栈 H' 替代 H，保证时间复杂度为常数。</p>
<h2 id="对复制时-enqueue-的支持和-t-的引入">对复制时 Enqueue 的支持和 T' 的引入</h2>
<p>刚才是一种理想情况，显然我们的队列在复制时不可能只发生出队操作，为了增加对入队操作的支持，我们引入临时栈 T'。</p>
<p>例如我们有队列状态如下，现在启动复制进程，入队操作全部由 T' 完成。 <img src="./10.png"> 我们进行一次入队操作和两次出队操作，如下组图所示：</p>
<p>第一次操作（入队） <img src="./11.png"> 第二次操作（出队） <img src="./12.png"> 第三次操作（出队） <img src="./13.png"> 现在 H 和 T 均为空，下一次操作时（不论入队还是出队），我们先交换 H 和 H' 以及 T 和 T'，同时让入队操作控制权回到 T。 <img src="./14.png"> 这样，我们增加了对复制时入队操作的支持，但还并不完全，只有在理想情况下才可以做到。</p>
<h2 id="h-与-hr-对复制时出入队序列支持的扩展">h 与 HR ，对复制时出入队序列支持的扩展</h2>
<p>在之前的例子中，当复制结束时 H 总是为空的，现在我们来讨论一下复制结束时 H 不为空的情况。 如果复制结束时 H 不为空，直接交换的结果是我们丢失了原来栈 H 中的数据。 因此，在翻转 T 的同时，我们还应翻转 H 到 HR，并在最后将 HR 的内容再度翻转并添加到 H' 上。 这个过程可以以下图方式进行： 初始状态： <img src="./15.png"> 第一次操作（入队），H-&gt;HR ,T-&gt;H'，时间复杂度 O(1) + O(1) + O(1) + O(1) + O(1) = O(1)。 <img src="./16.png"> 第二次操作（入队） <img src="./17.png"> 第三次操作（入队） <img src="./18.png"> 第四次操作（入队） <img src="./19.png"> 第五次操作（入队） <img src="./20.png"> 第六次操作（出/入队执行前） <img src="./21.png"> 这样我们就解决了 H 复制结束后不为空的问题，代价是引入了两个额外的问题：</p>
<p>问题一：操作次数增加到了 2k 次，k 代表栈 T 中的元素数量。（如果当 T 中元素数量大于 H 中元素数量时开始复制） 问题二：由于 H 被用于复制进程，我们无法在复制过程中支持出队操作。</p>
<p>第一个问题解决方案比较简单，我们可以在每一次出/入队操作执行时进行两次的复制步骤（对 T 和 H 进行两次的 Pop 操作），时间复杂度仍为 O(1)。 第二个问题我们通过引入栈 h 来解决。</p>
<p>h 用于在复制时代替 H 执行出队功能，它会在复制开始时自动变为栈 H 的一个浅拷贝（也就是说，h 和 H 共用同一片内存空间，但它们用于指示栈顶位置的指针相互独立）。</p>
<p>现在我们有了全部 6 个栈，它们的功能如下图所示（为了方便介绍我将一些栈的位置做了调换）。 <img src="./22.png"> 由于我们并不能预知接下来会发生的操作，因此当 H 栈中的元素数量第一次小于 T 栈中的元素数量时，我们就必须启动复制进程了（总是假设接下来全部都是出队操作）。我们引入一个布尔类型变量 IsCopying 来指示复制进程。 <img src="./23.png"> 现在我们进行第一次入队操作，IsCopying = true，开始复制。 首先 h 变为 H 的浅拷贝，这个过程是 O(1) 的。 <img src="./24.png"> 如果在复制过程中有出队操作，作为 H 的翻转 HR 中就有一个元素不再需要复制，我们引入一个变量 needcopy 来记录 HR 中需要复制的元素数量。 <img src="./25.png"> 接下来是两次复制操作，T 和 H 分别有两个元素进入了 H' 和 HR 。 <img src="./26.png"> 然后是第二次出/入队操作，这次我们选择出队，1 出队后显然 HR 中的 1 不再需要复制，needcopy – 1。 <img src="./27.png"> 随后再是两次复制操作，第一次将 H 中的 3 移到 HR 中，needcopy + 1，T 中的 5 移到 H' 中；第二次只将 T 中的 4 移到 H' 中。 <img src="./28.png"> 第三次出/入队操作我们选择入队，8 入队。随后 HR 中的两个元素进入了 H'，needcopy – 2。 <img src="./29.png"> 由于 needcopy 变成了 0，我们再额外进行一次交换操作，并将 IsCopying 置为 false。 <img src="./30.png"> 至此，完整的算法运行完毕。</p>
<h2 id="有关复制开始时机的证明">有关复制开始时机的证明</h2>
<p>这里我们选择了在第 k + 1 个元素入队时开始复制，现在证明一定能够在 h 空之前完成复制： 假设复制开始时 H 有 k 个元素，T 有 k + 1个元素。 完成第一轮复制（H-&gt;HR , T-&gt;H'）需要 k + 1 次操作， 完成第二轮复制（H-&gt;H'）需要 k 次操作，总共需要 2k + 1 次操作才能完成复制。 而 h 的长度为 k，能够提供 2k 次的操作机会。第 k + 1 个元素入队时也能提供 2 次操作机会，因此一共是 2k + 2 次操作机会。 由于 2k + 1 &lt; 2k + 2，我们证明了该算法能够及时完成复制工作。</p>
<h2 id="程序设计">程序设计</h2>
<p>根据之前的内容，我们可以开始设计程序了。主要实现三个功能，Enqueue(), Dequeue() 和 Peek()。 根据算法要求我们添加一个进行复制时操作的函数 OneStep()，用于执行元素的复制，栈交换等操作。 Peek() 只需要根据是否在进行复制选择栈 h 或栈 H 进行 Peek()。</p>
<p>Enqueue()</p>
<pre><code>1. 如果不处于复制状态
   1. 如果 H.Length – T.Length &gt; 0，直接将元素压入栈 T。
   2. 否则令 IsCopying = true，h 进行浅拷贝，进行两次的 OneStep。
2. 如果处于复制状态，将元素压入 T&#39;，进行两次的 OneStep</code></pre>
<p>Dequeue()</p>
<pre><code>1. 如果不处于复制状态
   1. 如果 H.Length – T.Length &gt; 0，直接从 H 弹出元素。
   2. 否则从 H 弹出元素，IsCopying = true，h 进行浅拷贝，进行两次的 OneStep。
2. 如果处于复制状态，从 h 弹出元素，needcopy - 1，进行两次的 OneStep。</code></pre>
<p>OneStep()</p>
<pre><code>1. 如果不处于复制状态，什么也不做。
2. 如果处于复制状态。
   1. 如果 H 和 T 都不为空，从 H 搬运一个元素至 HR  ，从 T 搬运一个元素至 H&#39; ，needcopy + 1。
   2. 如果 H 为空但 T 不为空，从 T 搬运一个元素至 H&#39; 。
   3. 如果 H 和 T 都为空，但 needcopy &gt; 1，从 HR  搬运一个元素至 H&#39; ，needcopy – 1。
   4. 如果 H 和 T 都为空，但 needcopy = 1，从 HR  搬运一个元素至 H&#39; ，needcopy – 1，交换 H 和 H&#39; 以及 T 和 T&#39;，其他栈置空，退出复制状态。
   5. 如果 H 和 T 都为空，但 needcopy = 0，交换 H 和 H&#39; 以及 T 和 T&#39;，其他栈置空，退出复制状态。</code></pre>
<h1 id="代码">代码</h1>
<div class="sourceCode" id="cb4"><pre class="sourceCode csharp"><code class="sourceCode cs"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">using</span> Generics;</a>
<a class="sourceLine" id="cb4-2" title="2"></a>
<a class="sourceLine" id="cb4-3" title="3"><span class="kw">namespace</span> _<span class="fl">1.</span>_<span class="fl">3.</span>_<span class="dv">49</span></a>
<a class="sourceLine" id="cb4-4" title="4">{</a>
<a class="sourceLine" id="cb4-5" title="5">    <span class="kw">class</span> StackQueue&lt;Item&gt;</a>
<a class="sourceLine" id="cb4-6" title="6">    {</a>
<a class="sourceLine" id="cb4-7" title="7">        Stack&lt;Item&gt; H;</a>
<a class="sourceLine" id="cb4-8" title="8">        Stack&lt;Item&gt; T;</a>
<a class="sourceLine" id="cb4-9" title="9">        Stack&lt;Item&gt; h;</a>
<a class="sourceLine" id="cb4-10" title="10">        Stack&lt;Item&gt; HH;</a>
<a class="sourceLine" id="cb4-11" title="11">        Stack&lt;Item&gt; TT;</a>
<a class="sourceLine" id="cb4-12" title="12">        Stack&lt;Item&gt; Hr;</a>
<a class="sourceLine" id="cb4-13" title="13"></a>
<a class="sourceLine" id="cb4-14" title="14">        <span class="dt">bool</span> isRecopying;</a>
<a class="sourceLine" id="cb4-15" title="15">        <span class="dt">int</span> nowcopying;</a>
<a class="sourceLine" id="cb4-16" title="16"></a>
<a class="sourceLine" id="cb4-17" title="17">        <span class="kw">public</span> <span class="fu">StackQueue</span>()</a>
<a class="sourceLine" id="cb4-18" title="18">        {</a>
<a class="sourceLine" id="cb4-19" title="19">            <span class="kw">this</span>.<span class="fu">isRecopying</span> = <span class="kw">false</span>;</a>
<a class="sourceLine" id="cb4-20" title="20">            <span class="kw">this</span>.<span class="fu">nowcopying</span> = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb4-21" title="21"></a>
<a class="sourceLine" id="cb4-22" title="22">            <span class="kw">this</span>.<span class="fu">H</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-23" title="23">            <span class="kw">this</span>.<span class="fu">T</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-24" title="24">            <span class="kw">this</span>.<span class="fu">h</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-25" title="25">            <span class="kw">this</span>.<span class="fu">HH</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-26" title="26">            <span class="kw">this</span>.<span class="fu">TT</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-27" title="27">            <span class="kw">this</span>.<span class="fu">Hr</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-28" title="28">        }</a>
<a class="sourceLine" id="cb4-29" title="29"></a>
<a class="sourceLine" id="cb4-30" title="30">        <span class="kw">public</span> Item <span class="fu">Peek</span>()</a>
<a class="sourceLine" id="cb4-31" title="31">        {</a>
<a class="sourceLine" id="cb4-32" title="32">            <span class="kw">if</span> (<span class="kw">this</span>.<span class="fu">isRecopying</span>)</a>
<a class="sourceLine" id="cb4-33" title="33">            {</a>
<a class="sourceLine" id="cb4-34" title="34">                <span class="kw">return</span> h.<span class="fu">Peek</span>();</a>
<a class="sourceLine" id="cb4-35" title="35">            }</a>
<a class="sourceLine" id="cb4-36" title="36">            <span class="kw">else</span></a>
<a class="sourceLine" id="cb4-37" title="37">            {</a>
<a class="sourceLine" id="cb4-38" title="38">                <span class="kw">return</span> H.<span class="fu">Peek</span>();</a>
<a class="sourceLine" id="cb4-39" title="39">            }</a>
<a class="sourceLine" id="cb4-40" title="40">        }</a>
<a class="sourceLine" id="cb4-41" title="41"></a>
<a class="sourceLine" id="cb4-42" title="42">        <span class="kw">public</span> <span class="dt">void</span> <span class="fu">Enqueue</span>(Item item)</a>
<a class="sourceLine" id="cb4-43" title="43">        {</a>
<a class="sourceLine" id="cb4-44" title="44">            <span class="kw">if</span> (!<span class="kw">this</span>.<span class="fu">isRecopying</span> &amp;&amp; <span class="fu">Lendiff</span>() &gt; <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-45" title="45">            {</a>
<a class="sourceLine" id="cb4-46" title="46">                <span class="kw">this</span>.<span class="fu">nowcopying</span> = <span class="dv">0</span>;</a>
<a class="sourceLine" id="cb4-47" title="47">                <span class="kw">this</span>.<span class="fu">T</span>.<span class="fu">Push</span>(item);</a>
<a class="sourceLine" id="cb4-48" title="48">            }</a>
<a class="sourceLine" id="cb4-49" title="49">            <span class="kw">else</span> <span class="kw">if</span> (!<span class="kw">this</span>.<span class="fu">isRecopying</span> &amp;&amp; <span class="fu">Lendiff</span>() == <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-50" title="50">            {</a>
<a class="sourceLine" id="cb4-51" title="51">                <span class="kw">this</span>.<span class="fu">T</span>.<span class="fu">Push</span>(item);</a>
<a class="sourceLine" id="cb4-52" title="52">                <span class="kw">this</span>.<span class="fu">isRecopying</span> = <span class="kw">true</span>;</a>
<a class="sourceLine" id="cb4-53" title="53">                <span class="kw">this</span>.<span class="fu">h</span> = <span class="kw">this</span>.<span class="fu">H</span>.<span class="fu">Copy</span>();</a>
<a class="sourceLine" id="cb4-54" title="54">                <span class="fu">OneStep</span>(<span class="fu">OneStep</span>(<span class="kw">this</span>));</a>
<a class="sourceLine" id="cb4-55" title="55">            }</a>
<a class="sourceLine" id="cb4-56" title="56">            <span class="kw">else</span> <span class="kw">if</span> (<span class="kw">this</span>.<span class="fu">isRecopying</span>)</a>
<a class="sourceLine" id="cb4-57" title="57">            {</a>
<a class="sourceLine" id="cb4-58" title="58">                <span class="kw">this</span>.<span class="fu">TT</span>.<span class="fu">Push</span>(item);</a>
<a class="sourceLine" id="cb4-59" title="59">                <span class="fu">OneStep</span>(<span class="fu">OneStep</span>(<span class="kw">this</span>));</a>
<a class="sourceLine" id="cb4-60" title="60">            }</a>
<a class="sourceLine" id="cb4-61" title="61">        }</a>
<a class="sourceLine" id="cb4-62" title="62"></a>
<a class="sourceLine" id="cb4-63" title="63">        <span class="kw">public</span> <span class="dt">int</span> <span class="fu">Lendiff</span>()</a>
<a class="sourceLine" id="cb4-64" title="64">        {</a>
<a class="sourceLine" id="cb4-65" title="65">            <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">H</span>.<span class="fu">Size</span>() - <span class="kw">this</span>.<span class="fu">T</span>.<span class="fu">Size</span>();</a>
<a class="sourceLine" id="cb4-66" title="66">        }</a>
<a class="sourceLine" id="cb4-67" title="67"></a>
<a class="sourceLine" id="cb4-68" title="68">        <span class="kw">public</span> Item <span class="fu">Dequeue</span>()</a>
<a class="sourceLine" id="cb4-69" title="69">        {</a>
<a class="sourceLine" id="cb4-70" title="70">            <span class="kw">if</span> (!<span class="kw">this</span>.<span class="fu">isRecopying</span> &amp;&amp; <span class="fu">Lendiff</span>() &gt; <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-71" title="71">            {</a>
<a class="sourceLine" id="cb4-72" title="72">                <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">H</span>.<span class="fu">Pop</span>();</a>
<a class="sourceLine" id="cb4-73" title="73">            }</a>
<a class="sourceLine" id="cb4-74" title="74">            <span class="kw">else</span> <span class="kw">if</span> (!<span class="kw">this</span>.<span class="fu">isRecopying</span> &amp;&amp; <span class="fu">Lendiff</span>() == <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-75" title="75">            {</a>
<a class="sourceLine" id="cb4-76" title="76">                Item temp = <span class="kw">this</span>.<span class="fu">H</span>.<span class="fu">Pop</span>();</a>
<a class="sourceLine" id="cb4-77" title="77">                <span class="kw">this</span>.<span class="fu">h</span> = <span class="kw">this</span>.<span class="fu">H</span>.<span class="fu">Copy</span>();</a>
<a class="sourceLine" id="cb4-78" title="78">                <span class="kw">this</span>.<span class="fu">isRecopying</span> = <span class="kw">true</span>;</a>
<a class="sourceLine" id="cb4-79" title="79">                <span class="fu">OneStep</span>(<span class="fu">OneStep</span>(<span class="kw">this</span>));</a>
<a class="sourceLine" id="cb4-80" title="80">                <span class="kw">return</span> temp;</a>
<a class="sourceLine" id="cb4-81" title="81">            }</a>
<a class="sourceLine" id="cb4-82" title="82">            <span class="kw">else</span></a>
<a class="sourceLine" id="cb4-83" title="83">            {</a>
<a class="sourceLine" id="cb4-84" title="84">                Item temp = <span class="kw">this</span>.<span class="fu">h</span>.<span class="fu">Pop</span>();</a>
<a class="sourceLine" id="cb4-85" title="85">                <span class="kw">this</span>.<span class="fu">nowcopying</span>--;</a>
<a class="sourceLine" id="cb4-86" title="86">                <span class="fu">OneStep</span>(<span class="fu">OneStep</span>(<span class="kw">this</span>));</a>
<a class="sourceLine" id="cb4-87" title="87">                <span class="kw">return</span> temp;</a>
<a class="sourceLine" id="cb4-88" title="88">            }</a>
<a class="sourceLine" id="cb4-89" title="89">        }</a>
<a class="sourceLine" id="cb4-90" title="90"></a>
<a class="sourceLine" id="cb4-91" title="91">        <span class="kw">private</span> <span class="kw">static</span> StackQueue&lt;Item&gt; <span class="fu">OneStep</span>(StackQueue&lt;Item&gt; q)</a>
<a class="sourceLine" id="cb4-92" title="92">        {</a>
<a class="sourceLine" id="cb4-93" title="93">            <span class="kw">if</span> (q.<span class="fu">isRecopying</span> &amp;&amp; !q.<span class="fu">H</span>.<span class="fu">IsEmpty</span>() &amp;&amp; !q.<span class="fu">T</span>.<span class="fu">IsEmpty</span>())</a>
<a class="sourceLine" id="cb4-94" title="94">            {</a>
<a class="sourceLine" id="cb4-95" title="95">                q.<span class="fu">nowcopying</span>++;</a>
<a class="sourceLine" id="cb4-96" title="96">                q.<span class="fu">HH</span>.<span class="fu">Push</span>(q.<span class="fu">T</span>.<span class="fu">Pop</span>());</a>
<a class="sourceLine" id="cb4-97" title="97">                q.<span class="fu">Hr</span>.<span class="fu">Push</span>(q.<span class="fu">H</span>.<span class="fu">Pop</span>());</a>
<a class="sourceLine" id="cb4-98" title="98">            }</a>
<a class="sourceLine" id="cb4-99" title="99">            <span class="kw">else</span> <span class="kw">if</span> (q.<span class="fu">isRecopying</span> &amp;&amp; q.<span class="fu">H</span>.<span class="fu">IsEmpty</span>() &amp;&amp; !q.<span class="fu">T</span>.<span class="fu">IsEmpty</span>())</a>
<a class="sourceLine" id="cb4-100" title="100">            {</a>
<a class="sourceLine" id="cb4-101" title="101">                q.<span class="fu">isRecopying</span> = <span class="kw">true</span>;</a>
<a class="sourceLine" id="cb4-102" title="102">                q.<span class="fu">HH</span>.<span class="fu">Push</span>(q.<span class="fu">T</span>.<span class="fu">Pop</span>());</a>
<a class="sourceLine" id="cb4-103" title="103">            }</a>
<a class="sourceLine" id="cb4-104" title="104">            <span class="kw">else</span> <span class="kw">if</span> (q.<span class="fu">isRecopying</span> &amp;&amp; q.<span class="fu">H</span>.<span class="fu">IsEmpty</span>() &amp;&amp; q.<span class="fu">T</span>.<span class="fu">IsEmpty</span>() &amp;&amp; q.<span class="fu">nowcopying</span> &gt; <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-105" title="105">            {</a>
<a class="sourceLine" id="cb4-106" title="106">                q.<span class="fu">isRecopying</span> = <span class="kw">true</span>;</a>
<a class="sourceLine" id="cb4-107" title="107">                q.<span class="fu">nowcopying</span>--;</a>
<a class="sourceLine" id="cb4-108" title="108">                q.<span class="fu">HH</span>.<span class="fu">Push</span>(q.<span class="fu">Hr</span>.<span class="fu">Pop</span>());</a>
<a class="sourceLine" id="cb4-109" title="109">            }</a>
<a class="sourceLine" id="cb4-110" title="110">            <span class="kw">else</span> <span class="kw">if</span> (q.<span class="fu">isRecopying</span> &amp;&amp; q.<span class="fu">H</span>.<span class="fu">IsEmpty</span>() &amp;&amp; q.<span class="fu">T</span>.<span class="fu">IsEmpty</span>() &amp;&amp; q.<span class="fu">nowcopying</span> == <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb4-111" title="111">            {</a>
<a class="sourceLine" id="cb4-112" title="112">                q.<span class="fu">isRecopying</span> = <span class="kw">false</span>;</a>
<a class="sourceLine" id="cb4-113" title="113">                q.<span class="fu">nowcopying</span>--;</a>
<a class="sourceLine" id="cb4-114" title="114">                q.<span class="fu">HH</span>.<span class="fu">Push</span>(q.<span class="fu">Hr</span>.<span class="fu">Pop</span>());</a>
<a class="sourceLine" id="cb4-115" title="115">                q.<span class="fu">H</span> = q.<span class="fu">HH</span>;</a>
<a class="sourceLine" id="cb4-116" title="116">                q.<span class="fu">T</span> = q.<span class="fu">TT</span>;</a>
<a class="sourceLine" id="cb4-117" title="117">                q.<span class="fu">HH</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-118" title="118">                q.<span class="fu">TT</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-119" title="119">                q.<span class="fu">Hr</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-120" title="120">                q.<span class="fu">h</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-121" title="121">            }</a>
<a class="sourceLine" id="cb4-122" title="122">            <span class="kw">else</span> <span class="kw">if</span> (q.<span class="fu">isRecopying</span> &amp;&amp; q.<span class="fu">H</span>.<span class="fu">IsEmpty</span>() &amp;&amp; q.<span class="fu">T</span>.<span class="fu">IsEmpty</span>() &amp;&amp; q.<span class="fu">nowcopying</span> == <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb4-123" title="123">            {</a>
<a class="sourceLine" id="cb4-124" title="124">                q.<span class="fu">isRecopying</span> = <span class="kw">false</span>;</a>
<a class="sourceLine" id="cb4-125" title="125">                q.<span class="fu">H</span> = q.<span class="fu">HH</span>;</a>
<a class="sourceLine" id="cb4-126" title="126">                q.<span class="fu">T</span> = q.<span class="fu">TT</span>;</a>
<a class="sourceLine" id="cb4-127" title="127">                q.<span class="fu">HH</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-128" title="128">                q.<span class="fu">TT</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-129" title="129">                q.<span class="fu">Hr</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-130" title="130">                q.<span class="fu">h</span> = <span class="kw">new</span> Stack&lt;Item&gt;();</a>
<a class="sourceLine" id="cb4-131" title="131">            }</a>
<a class="sourceLine" id="cb4-132" title="132">            <span class="kw">return</span> q;</a>
<a class="sourceLine" id="cb4-133" title="133">        }</a>
<a class="sourceLine" id="cb4-134" title="134">    }</a>
<a class="sourceLine" id="cb4-135" title="135">}</a></code></pre></div>
<h1 id="另请参阅">另请参阅</h1>
<p><a href="https://stackoverflow.com/questions/5538192/how-to-implement-a-queue-with-three-stacks" target="_blank" rel="noopener">StackOverflow-How to implement a queue with three stacks?</a>——Stack Overflow 上关于这个问题的讨论。</p>
<p><a href="https://ecommons.cornell.edu/bitstream/handle/1813/6273/80-433.pdf?sequence=1&amp;isAllowed=y" target="_blank" rel="noopener">Real Time Queue Operation in Pure LISP-Robert Hood, Robert Melville</a>——用六个栈实现常数操作队列的论文。</p>

		</div>
	</div>

	

	
	
</div>

	
	
	
	<div class="section" id="Pagenation">
		
		<a href="/1-3-50/">Prev</a>
		
		
		<a href="/1-3-48/">Next</a>
		
	</div>
	

            <footer>
	<div class="footer_wrap">
		<div class="social">
			<ul class="clearfix">
				
				
				<li> <a href="https://github.com/ikesnowy/Algorithms-4th-Edition-in-Csharp" target="_blank"> <img src="/img/GitHub.png"> </a> </li>
				
				
				
				
				
				
				
				
			</ul>
		</div>
		<img src="/img/line.jpg">
		<div class="copyright">
			&copy; 2019 《算法（第四版）》C# 题解 | Provided By  <a title="沈星繁" href="http://chengkang.me/" target="_blank">沈星繁</a>
		</div>
	</div>
</footer>
        </div>
        <script type="text/javascript">
        function scrollYListener() {
        var searchHeight = parseInt(getComputedStyle(document.getElementById("Search")).height)
        var width = document.documentElement.clientWidth;
        var supportPageOffset = window.pageXOffset !== undefined;
        var isCSS1Compat = ((document.compatMode || "") === "CSS1Compat");
        var scrollY = supportPageOffset ? window.pageYOffset : isCSS1Compat ? document.documentElement.scrollTop : document.body.scrollTop;
        if (scrollY >= searchHeight-10) {
        document.getElementsByTagName('header')[0].style.backgroundColor = "#cd4b4b";
        document.getElementsByClassName('logo')[0].style.backgroundColor = "#cd4b4b";
        } else {
        document.getElementsByTagName('header')[0].style.backgroundColor = "#4f8e8e";
        document.getElementsByClassName('logo')[0].style.backgroundColor = "#4f8e8e";
        }
        }
        var isMenuExpanded = false;
        document.getElementById("mobile_menu_btn").onclick = function toggleMobileMenu() {
        if (isMenuExpanded) {
        document.getElementsByClassName('slide_menu')[0].className = "slide_menu";
        } else {
        document.getElementsByClassName('slide_menu')[0].className += " mobile_menu_active";
        }
        isMenuExpanded = !isMenuExpanded;
        }
        </script>
        
        <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-121852990-1', 'auto');
        ga('send', 'pageview');
        </script><!-- hexo-inject:begin --><!-- hexo-inject:end -->
        
        
    </body>
</html>